(function(f){var h;h=function(j){function i(){}i.generate=function(){var k=i._getRandomInt,l=i._hexAligner;return l(k(32),8)+"-"+l(k(16),4)+"-"+l(16384|k(12),4)+"-"+l(32768|k(14),4)+"-"+l(k(48),12)};i._getRandomInt=function(k){if(0>k||53<k){return NaN}var l=0|1073741824*Math.random();return 30<k?l+1073741824*(0|Math.random()*(1<<k-30)):l>>>30-k};i._hexAligner=function(k,o){for(var l=k.toString(16),n=o-l.length,m="0";0<n;n>>>=1,m+=m){n&1&&(l=m+l)}return l};i.overwrittenUUID=j;"undefined"!==typeof module&&module&&module.exports&&(module.exports=i);return i}(h);var g={data:undefined,search:true,title:"SelectMenu",regular:false,rightClick:false,arrow:false,position:"left",embed:false,lang:"cn",multiple:false,listSize:10,maxSelectLimit:0,selectToCloseList:false,initSelected:undefined,keyField:"id",showField:"name",searchField:undefined,andOr:"AND",orderBy:undefined,pageSize:100,formatItem:undefined,eSelect:undefined,eTabSwitch:undefined};var b=function(i,j){this.target=i;this.setOption(j);if(this.option.embed&&!f(i).is("div")){console.warn('SelectMenu embed mode need a "div" container element!');return}this.setLanguage();this.setCssClass();this.setProp();if(j.regular){this.setRegularMenu()}else{this.setElem()}if(!j.rightClick){this.populate()}this.eInput();if(!j.embed){this.eWhole()}this.atLast()};b.version="2.0";b.dataKey="selectMenuObject";b.dataTypeList="SelectMenuList";b.dataTypeGroup="SelectMenuGroup";b.dataTypeMenu="SelectMenuMenu";b.prototype.setOption=function(i){i.searchField=i.searchField||i.showField;if(i.regular&&i.title===g.title){i.title=false}if(i.embed||i.rightClick){i.arrow=false}i.andOr=i.andOr.toUpperCase();if(i.andOr!=="AND"&&i.andOr!=="OR"){i.andOr="AND"}i.orderBy=(i.orderBy===undefined)?i.showField:i.orderBy;i.orderBy=this.setOrderbyOption(i.orderBy,i.showField);if(f.type(i.data)==="string"){i.autoSelectFirst=false}if(f.type(i.listSize)!=="number"||i.listSize<0){i.listSize=12}this.option=i};b.prototype.setOrderbyOption=function(k,n){var j=[],m=[];if(typeof k=="object"){for(var l=0;l<k.length;l++){m=f.trim(k[l]).split(" ");j[l]=(m.length==2)?m:[m[0],"ASC"]}}else{m=f.trim(k).split(" ");j[0]=(m.length==2)?m:(m[0].match(/^(ASC|DESC)$/i))?[n,m[0]]:[m[0],"ASC"]}return j};b.prototype.setLanguage=function(){var i;switch(this.option.lang){case"cn":i={select_all_btn:"选择所有 (或当前页签) 项目",remove_all_btn:"清除所有选中的项目",close_btn:"关闭菜单 (Esc键)",loading:"读取中...",select_ng:"请注意：请从列表中选择.",select_ok:"OK : 已经选择.",not_found:"无查询结果",ajax_error:"连接到服务器时发生错误！",max_selected:"最多只能选择 max_selected_limit 个项目"};break;case"en":i={select_all_btn:"Select All (Tabs) items",remove_all_btn:"Clear all selected items",close_btn:"Close Menu (Esc key)",loading:"loading...",select_ng:"Attention : Please choose from among the list.",select_ok:"OK : Correctly selected.",not_found:"not found",ajax_error:"An error occurred while connecting to server.",max_selected:"You can only select up to max_selected_limit items"};break;case"ja":i={select_all_btn:"すべての （または現在のタブ） 項目を選択",remove_all_btn:"選択したすべての項目をクリアする",close_btn:"閉じる (Tabキー)",loading:"読み込み中...",select_ng:"注意 : リストの中から選択してください",select_ok:"OK : 正しく選択されました。",not_found:"(0 件)",ajax_error:"サーバとの通信でエラーが発生しました。",max_selected:"最多で max_selected_limit のプロジェクトを選ぶことしかできません"};break;case"de":i={select_all_btn:"Wählen Sie alle (oder aktuellen Registerkarten) aus",remove_all_btn:"Alle ausgewählten Elemente löschen",close_btn:"Schließen (Tab)",loading:"lade...",select_ng:"Achtung: Bitte wählen Sie aus der Liste aus.",select_ok:"OK : Richtig ausgewählt.",not_found:"nicht gefunden",ajax_error:"Bei der Verbindung zum Server ist ein Fehler aufgetreten.",max_selected:"Sie können nur bis zu max_selected_limit Elemente auswählen"};break;case"es":i={select_all_btn:"Seleccionar todos los elementos (o la pestaña actual)",remove_all_btn:"Borrar todos los elementos seleccionados",close_btn:"Cerrar (tecla TAB)",loading:"Cargando...",select_ng:"Atencion: Elija una opcion de la lista.",select_ok:"OK: Correctamente seleccionado.",not_found:"no encuentre",ajax_error:"Un error ocurrió mientras conectando al servidor.",max_selected:"Solo puedes seleccionar hasta max_selected_limit elementos"};break;case"pt-br":i={select_all_btn:"Selecione todos os itens (ou guia atual)",remove_all_btn:"Limpe todos os itens selecionados",close_btn:"Fechar (tecla TAB)",loading:"Carregando...",select_ng:"Atenção: Escolha uma opção da lista.",select_ok:"OK: Selecionado Corretamente.",not_found:"não encontrado",ajax_error:"Um erro aconteceu enquanto conectando a servidor.",max_selected:"Você só pode selecionar até max_selected_limit itens"};break}this.message=i};b.prototype.setCssClass=function(){var i={target_clicked:"sm_target_clicked",container:"sm_container",container_open:"sm_container_open",container_embed:"sm_embed",header:"sm_header",re_area:"sm_result_area",re_tabs:"sm_result_tabs",re_list:"sm_list_mode",control_box:"sm_control_box",two_btn:"sm_two_btn",element_box:"sm_element_box",results:"sm_results",re_off:"sm_results_off",select:"sm_over",selected_icon:"sm_selected_icon",item_text:"sm_item_text",select_ok:"sm_select_ok",select_ng:"sm_select_ng",selected:"sm_selected",input_off:"sm_input_off",message_box:"sm_message_box",btn_close:"sm_close_button",btn_selectall:"sm_selectall_button",btn_removeall:"sm_removeall_button",btn_on:"sm_btn_on",btn_out:"sm_btn_out",btn_back:"sm_sub_back",input:"sm_input",input_area:"sm_input_area",clear_btn:"sm_clear_btn",menu_root:"sm_menu_root",menu_divider:"sm_divider",menu_regular:"sm_regular",menu_arrow:"sm_arrow",menu_arrow_have_title:"sm_have_title",menu_disabled:"sm_disabled",menu_header:"sm_header",menu_caret:"sm_caret",menu_sub_menu:"sm_sub_menu",menu_sub_item:"sm_sub_item",menu_sub_header:"sm_sub_header",direction_top:"sm_arrow_top",direction_bottom:"sm_arrow_bottom"};this.css_class=i;this.template={msg:{maxSelectLimit:"max_selected_limit"}}};b.prototype.setProp=function(){this.prop={values:[],data:undefined,data_index:0,key_select:false,prev_value:"",selected_text:"",last_input_time:undefined,data_type:b.dataTypeList,menu_tab_id_prefix:"selectmenu_tab_",menu_code_prefix:"selectmenu_",x:undefined,y:undefined}};b.prototype.checkDataType=function(l){var i=this,j=this.option;if(l&&f.isArray(l)&&l.length){if(j.regular){return b.dataTypeMenu}else{var k=l[0];if(k.hasOwnProperty("title")&&k.hasOwnProperty("list")&&f.isArray(k.list)){return b.dataTypeGroup}else{return b.dataTypeList}}}else{return null}};b.prototype.setElem=function(){var i=this,l=this.option,j=this.css_class;var k={};k.container=l.embed?f(i.target).addClass(j.container_embed):f("<div>");k.container.addClass(j.container).addClass(j.direction_bottom);if(l.title){k.header=f("<div>").addClass(j.header);k.header.append("<h3>"+l.title+"</h3>");if(l.multiple){k.selectAllButton=f('<button type="button"><i class="iconfont icon-selectall"></i></button>').attr("title",this.message.select_all_btn).addClass(j.btn_selectall);k.removeAllButton=f('<button type="button"><i class="iconfont icon-removeall"></i></button>').attr("title",this.message.remove_all_btn).addClass(j.btn_removeall);k.header.append(k.selectAllButton);k.header.append(k.removeAllButton)}if(!l.embed){k.closeButton=f('<button type="button">×</button>').attr("title",i.message.close_btn).addClass(j.btn_close);k.header.append(k.closeButton)}}k.inputArea=f("<div>").addClass(j.input_area);k.input=f('<input type="text" autocomplete="off">').addClass(j.input);k.resultArea=f("<div>").addClass(j.re_area);k.resultTabs=f("<div>").addClass(j.re_tabs);k.results=f("<ul>").addClass(j.results);k.selectedIcon=f('<i class="iconfont icon-selected">');if(l.arrow){k.arrow=f("<div>").addClass(j.menu_arrow);if(l.title){k.arrow.addClass(j.menu_arrow_have_title)}k.container.append(k.arrow)}if(l.title){k.container.append(k.header)}if(l.search){k.container.append(k.inputArea);k.inputArea.append(k.input)}k.container.append(k.resultTabs).append(k.resultArea);k.resultArea.append(k.results);if(!l.embed){f(document.body).append(k.container)}this.elem=k};b.prototype.setRegularMenu=function(){var l=this.option,i=this,j=this.css_class;var k={};k.container=l.embed?f(i.target).addClass(j.container_embed):f("<div>");k.container.addClass(j.container).addClass(j.direction_bottom).addClass(j.menu_regular);if(l.title){k.header=f("<div>").addClass(j.header);k.header.append("<h3>"+l.title+"</h3>");if(!l.embed){k.closeButton=f('<button type="button">×</button>').attr("title",i.message.close_btn).addClass(j.btn_close)}}k.resultArea=f("<div>").addClass(j.re_area);k.results=f("<ul>").addClass(j.results).addClass(j.menu_root);if(l.arrow){k.arrow=f("<div>").addClass(j.menu_arrow);if(l.title){k.arrow.addClass(j.menu_arrow_have_title)}k.container.append(k.arrow)}if(l.title){k.container.append(k.header);if(!l.embed){k.header.append(k.closeButton)}}k.container.append(k.resultArea);k.resultArea.append(k.results);if(!l.embed){f(document.body).append(k.container)}this.elem=k};b.prototype.regularMenuInit=function(){var o=this.prop.data,n=this.option,i=this,l=this.css_class,m=i.elem;var j=function(){if(!n.embed){this.calcResultsSize(this);m.container.addClass(l.container_open)}};if(m.results.find("li").size()&&!f.isFunction(n.data)){j.call(i);return}if(o&&f.isArray(o)&&o.length){var k=function(q,p){if(p.hasClass(l.menu_root)){p.empty().hide()}f.each(q,function(v,w){if(!w.content||(!w.header&&!w.url&&!w.callback&&!w.menus&&w.content!==l.menu_divider)){return true}var r=f("<li>");if(w.content===l.menu_divider){r.addClass(l.menu_divider)}else{var s=f("<a>").html(w.content).attr("href",(w.url&&!w.disabled)?w.url:"javascript:void(0);");if(w.callback&&f.isFunction(w.callback)&&!w.url){s.on("click.selectMenu",function(z){z.stopPropagation();if(w.disabled){return}w.callback();i.hideResults(i)})}if(w.menus&&f.isArray(w.menus)&&w.menus.length){var y=i.prop.menu_code_prefix+h.generate();s.attr({"href":"javascript:void(0);","item_code":y}).append(f("<span>").addClass(l.menu_caret)).addClass(l.menu_sub_item);var t=f("<ul>").attr("id",y).addClass(l.results).addClass(l.menu_sub_menu);var u=f('<button type="button">').addClass(l.btn_back).append('<i class="iconfont icon-back"></i>');var x=f("<li>").append(u).append(f("<p>").text(w.content)).addClass(l.menu_sub_header);t.append(x).append(f("<li>").addClass(l.menu_divider));m.resultArea.append(t);k(w.menus,t)}r.prepend(s);if(w.disabled){r.addClass(l.menu_disabled)}if(w.header){r.addClass(l.menu_header)}}p.append(r)});if(!p.hasClass(l.menu_sub_menu)){p.show()}};m.resultArea.find("ul."+l.results+":not(."+l.menu_root+")").remove();k(o,m.results);m.resultArea.find("a."+l.menu_sub_item).off("click.SelectMenu").on("click.SelectMenu",function(r){r.preventDefault();r.stopPropagation();var q=f(this),p=q.closest("ul."+l.results),s=f("#"+q.attr("item_code"));if(s.size()){p.hide();s.addClass("vivify fadeInRight").show()}});m.resultArea.find("button."+l.btn_back).off("click.SelectMenu").on("click.SelectMenu",function(s){var r=f(this),q=r.closest("ul"),p=f('a[item_code="'+q.attr("id")+'"]').closest("ul");q.hide();p.addClass("vivify fadeInLeft").show()});j.call(i)}};b.prototype.showMenu=function(i){i.populate();if(f(i.target).is("button")){f(i.target).addClass(i.css_class.target_clicked)}};b.prototype.setInitSelected=function(j,k){var l=j.option;if(f.type(l.initSelected)!=="undefined"&&!l.regular&&k&&f.isArray(k)&&k.length){var m=String(l.initSelected),i=m.split(",");f.each(k,function(n,o){var p=String(o[l.keyField]);if(p&&f.inArray(p,i)!==-1){j.prop.values.push(o)}});l.initSelected=undefined}};b.prototype.eInput=function(){var i=this,k=this.option,j=i.elem;if(!k.regular&&k.search){j.input.keyup(function(l){i.processKey(i,l)}).keydown(function(l){i.processControl(i,l)})}if(k.title){if(!k.embed){j.closeButton.click(function(l){i.hideResults(i)})}if(!k.regular){if(k.multiple){j.selectAllButton.click(function(l){l.stopPropagation();i.selectAllLine(i)});j.removeAllButton.click(function(l){l.stopPropagation();i.clearAll(i)})}}}if(!k.regular&&i.prop.data_type===b.dataTypeGroup){j.resultTabs.on("click.selectMenu","a",function(n){n.stopPropagation();if(!f(this).hasClass("active")){var l=f(this).closest("li");l.siblings().children("a").removeClass("active");f(this).addClass("active");i.prop.data_index=parseInt(f(this).attr("data_index"));i.populate();if(k.eTabSwitch&&f.isFunction(k.eTabSwitch)){var m=f.extend({},i.prop.data[i.prop.data_index]);delete m.list;k.eTabSwitch.call(this,i.prop.data_index,m)}}})}if(k.rightClick){f(i.target).on("contextmenu",function(m){m.preventDefault();m.stopPropagation();m.cancelBubble=true;m.returnValue=false;var n=document.documentElement.scrollLeft||document.body.scrollLeft,l=document.documentElement.scrollTop||document.body.scrollTop;i.prop.x=m.pageX||m.clientX+n;i.prop.y=m.pageY||m.clientY+l;if(!i.isVisible(i)){i.populate()}else{i.calcResultsSize(i)}return false}).mouseup(function(l){if(l.button!=2){i.hideResults(i)}});i.hideResults(i)}};b.prototype.eWhole=function(){var i=this,j=this.css_class;f(document).off("mouseup.selectMenu").on("mouseup.selectMenu",function(l){var k=l.target||l.srcElement,m=f(k).closest("div."+j.container);f("div."+j.container+"."+j.container_open).each(function(){var n=f(this).data(b.dataKey);if(this==m[0]||n.target==k||f(k).closest(n.target).size()){return}n.hideResults(n)})})};b.prototype.eResultList=function(){var i=this;i.elem.results.children("li").mouseenter(function(){if(i.prop.key_select){i.prop.key_select=false;return}if(!f(this).hasClass("sm_message_box")){f(this).addClass(i.css_class.select)}}).mouseleave(function(){f(this).removeClass(i.css_class.select)}).click(function(j){if(i.prop.key_select){i.prop.key_select=false;return}j.preventDefault();j.stopPropagation();i.selectCurrentLine(i,false)})};b.prototype.eScroll=function(){var i=this,j=this.css_class;f(window).on("scroll.SelectMenu",function(k){f("div."+j.container+"."+j.container_open).each(function(){var r=f(this).data(b.dataKey),q=r.elem.container.offset(),o=f(window).scrollTop(),t=f(document).height(),m=f(window).height(),l=r.elem.container.outerHeight(),p=q.top+l,n=t>m,s=r.elem.container.hasClass(j.direction_bottom);if(n){if(s){if(p>(m+o)){r.calcResultsSize(r)}}else{if(q.top<o){r.calcResultsSize(r)}}}})})};b.prototype.atLast=function(i){if(!i){i=this}var j=i.option;if(j.search&&!j.regular&&!j.embed&&!j.rightClick){i.elem.input.focus()}i.elem.container.data(b.dataKey,i);if(f(i.target).is("button,.btn")&&!j.embed&&!j.rightClick){f(i.target).addClass(i.css_class.target_clicked)}};b.prototype.ajaxErrorNotify=function(i,j){i.showMessage(i.message.ajax_error)};b.prototype.showMessage=function(i,k){if(!k){return}var j='<li class="sm_message_box"><i class="iconfont icon-warn"></i> '+k+"</li>";i.elem.results.empty().append(j);i.calcResultsSize(i);i.elem.container.addClass(i.css_class.container_open);i.elem.control.hide()};b.prototype.checkValue=function(j){var i=j.elem.input.val();if(i!=j.prop.prev_value){j.prop.prev_value=i;j.suggest(j)}};b.prototype.processKey=function(i,j){if(f.inArray(j.keyCode,[38,40,27,9,13])===-1){if(f.type(i.option.data)==="string"){i.prop.last_input_time=j.timeStamp;setTimeout(function(){if((j.timeStamp-i.prop.last_input_time)===0){i.checkValue(i)}},i.option.inputDelay*1000)}else{i.checkValue(i)}}};b.prototype.processControl=function(i,j){if((f.inArray(j.keyCode,[38,40,27,9])>-1&&i.elem.container.is(":visible"))||(f.inArray(j.keyCode,[13,9])>-1&&i.getCurrentLine(i))){j.preventDefault();j.stopPropagation();j.cancelBubble=true;j.returnValue=false;switch(j.keyCode){case 38:i.prop.key_select=true;i.prevLine(i);break;case 40:if(i.elem.results.children("li").length){i.prop.key_select=true;i.nextLine(i)}else{i.suggest(i)}break;case 9:i.selectCurrentLine(i,true);break;case 13:i.selectCurrentLine(i,true);break;case 27:i.hideResults(i);break}}};b.prototype.populate=function(){var i=this,j=this.option;if(!j.regular){i.elem.input.val("")}if(j.data){if(f.type(j.data)==="array"){i.prop.data=j.data}else{if(f.type(j.data)==="function"){i.prop.data=j.data()}}}if(f.type(i.prop.data)==="array"){this.prop.data_type=this.checkDataType(i.prop.data)}if(f.type(j.data)!=="string"){i.setInitSelected(i,i.prop.data)}if(j.regular){i.regularMenuInit()}else{i.suggest(i)}if(!j.embed){i.eScroll()}};b.prototype.suggest=function(i){var j,k=i.option,l=f.trim(i.elem.input.val());if(k.multiple){j=l}else{if(l&&l===i.prop.selected_text){j=""}else{j=l}}j=j.split(/[\s　]+/);i.setLoading(i);if(f.type(k.data)==="array"||f.type(k.data)==="function"){i.search(i,j)}};b.prototype.setLoading=function(i){if(i.elem.results.html()===""){if(!i.option.embed){i.elem.container.addClass(i.css_class.container_open)}}};b.prototype.search=function(u,n){var v=u.option,x=u.prop.data,r=[],m=[],k=[],D={},z=0,t=[];do{m[z]=n[z].replace(/\W/g,"\\$&").toString();t[z]=new RegExp(m[z],"gi");z++}while(z<n.length);var F=[];if(u.prop.data_index>(v.data.length-1)||u.prop.data_index<0){u.prop.data_index=0}if(u.prop.data_type===b.dataTypeGroup){F=x[u.prop.data_index].list}else{F=x}for(z=0;z<F.length;z++){var y=false;var o=F[z];for(var w=0;w<t.length;w++){var q=o[v.searchField];if(v.formatItem&&f.isFunction(v.formatItem)){q=v.formatItem(o)}if(q.match(t[w])){y=true;if(v.andOr=="OR"){break}}else{y=false;if(v.andOr=="AND"){break}}}if(y){r.push(o)}}var G=new RegExp("^"+m[0]+"$","gi"),E=new RegExp("^"+m[0],"gi"),C=[],B=[],A=[];for(z=0;z<r.length;z++){var s=v.orderBy[0][0],l=String(r[z][s]);if(l.match(G)){C.push(r[z])}else{if(l.match(E)){B.push(r[z])}else{A.push(r[z])}}}if(v.orderBy[0][1].match(/^asc$/i)){C=u.sortAsc(u,C);B=u.sortAsc(u,B);A=u.sortAsc(u,A)}else{C=u.sortDesc(u,C);B=u.sortDesc(u,B);A=u.sortDesc(u,A)}k=k.concat(C).concat(B).concat(A);D.originalResult=[];if(D.keyField===undefined){D.keyField=[]}if(D.candidate===undefined){D.candidate=[]}f.each(k,function(j,p){if(p===undefined||f.type(p)!=="object"){return true}D.originalResult.push(p);if(p.hasOwnProperty(v.keyField)&&p.hasOwnProperty(v.showField)){D.keyField.push(p[v.keyField]);D.candidate.push(p[v.showField])}});u.prepareResults(u,D,n)};b.prototype.sortAsc=function(j,i){i.sort(function(m,k){var n=m[j.option.orderBy[0][0]],l=k[j.option.orderBy[0][0]];return f.type(n)==="number"?n-l:String(n).localeCompare(String(l))});return i};b.prototype.sortDesc=function(j,i){i.sort(function(m,k){var n=m[j.option.orderBy[0][0]],l=k[j.option.orderBy[0][0]];return f.type(n)==="number"?l-n:String(l).localeCompare(String(n))});return i};b.prototype.notFoundSearch=function(i){i.elem.results.empty();i.calcResultsSize(i);i.elem.container.addClass(i.css_class.container_open);i.setCssFocusedInput(i)};b.prototype.prepareResults=function(j,k,l){if(!k.keyField){k.keyField=false}if(j.option.selectOnly&&k.candidate.length===1&&k.candidate[0]==l[0]){j.elem.hidden.val(k.keyField[0]);this.setButtonAttrDefault()}var i=false;if(l&&l.length&&l[0]){i=true}j.setInitSelected(j,k.originalResult);j.displayResults(j,k,i)};b.prototype.displayResults=function(t,A,z){var v=t.option,k=t.elem,o=t.css_class;k.results.hide().empty();if(t.prop.data_type===b.dataTypeGroup){var s=f("<ul>");f.each(t.prop.data,function(E,F){var D=f('<a href="javascript:void(0);">').html(F.title).attr({"tab_id":t.prop.menu_tab_id_prefix+(E+1),"data_index":E});if(E===t.prop.data_index){D.addClass("active")}var p=f("<li>").append(D);s.append(p)});k.resultTabs.empty().append(s)}else{k.resultTabs.hide();if(v.title||v.search){k.resultArea.addClass(this.css_class.re_list)}}if(v.multiple&&f.type(v.maxSelectLimit)==="number"&&v.maxSelectLimit>0){var w=k.element_box.find("li.selected_tag").size();if(w>0&&w>=v.maxSelectLimit){var l=t.message.max_selected;t.showMessage(t,l.replace(t.template.msg.maxSelectLimit,v.maxSelectLimit));return}}if(A.candidate.length>0){var y=A.candidate,u=A.keyField;for(var x=0;x<y.length;x++){var n="",j=false,m=A.originalResult[x];if(v.formatItem&&f.isFunction(v.formatItem)){try{n=v.formatItem(m);j=true}catch(C){console.error("formatItem 内容格式化函数内容设置不正确！");n=y[x]}}else{n=y[x]}var B=f("<div>").html('<i class="iconfont icon-selected">').addClass(o.selected_icon),r=f("<div>").html(n).addClass(o.item_text),q=f("<li>").append(B).append(r).attr("pkey",u[x]);if(!j){q.attr("title",n)}if(f.inArray(m,t.prop.values)!==-1){q.addClass(o.selected)}q.data("dataObj",m);k.results.append(q)}}else{var q='<li class="sm_message_box"><i class="iconfont icon-warn"></i> '+t.message.not_found+"</li>";k.results.append(q)}k.results.show();t.calcResultsSize(t);if(!v.embed){k.container.addClass(o.container_open)}t.eResultList();t.atLast(t)};b.prototype.calcResultsSize=function(l){var q=l.option,n=l.elem,m=l.css_class,o=function(){return f(document).height()>f(window).height()};var i=function(){if(!q.regular){var r=n.results.find("li:first").outerHeight(),p=r*q.listSize;n.results.css({"max-height":p})}};var k=o();var j=function(){var p=n.container.outerHeight(),u=f(window).scrollTop(),r=f(window).height();if(q.rightClick){var x=l.prop.y;if((l.prop.y+p)>(u+r)){x=l.prop.y-p}return{top:x,left:l.prop.x}}var z=f(l.target).offset(),A=z.top,v=n.container.outerWidth(),y=Math.round(f(l.target)[0].getBoundingClientRect().width),w=5;A+=f(l.target).outerHeight()+w;if(q.arrow&&!q.embed){A+=n.arrow.outerHeight(true)}if((A+p)>(u+r)){A=z.top-w-p;if(q.arrow&&!q.embed){A-=n.arrow.outerHeight(true)}n.container.removeClass(m.direction_bottom).addClass(m.direction_top)}else{if(n.container.hasClass(m.direction_top)){n.container.removeClass(m.direction_top).addClass(m.direction_bottom)}}var s=z.left;switch(q.position){case"right":s=s+y-v;if(q.arrow){n.arrow.css("left",v-(y/2))}break;case"center":s=s+(y/2)-(v/2);break;case"left":default:if(q.arrow){n.arrow.css("left",y/2)}break}return{top:A,left:s}};if(n.container.is(":visible")){i();if(!q.embed){n.container.offset(j())}}else{n.container.show(1,function(){i();f(this).offset(j())})}if(k!==o()){n.container.offset(j())}};b.prototype.subMenuPosition=function(m,n){var k=f(m).offset();var j=k.top,i=k.left+f(m).outerWidth()+5};b.prototype.hideResults=function(i){if(i.option.autoFillResult){}if(!i.option.regular){i.elem.results.empty()}if(!i.option.embed){i.elem.container.removeClass(i.css_class.container_open).hide();if(f(i.target).is("button,.btn")){f(i.target).removeClass(i.css_class.target_clicked)}}i.elem.resultArea.find("ul."+i.css_class.results).not("."+i.css_class.menu_root).hide();i.elem.results.removeClass("vivify").removeClass("fadeInLeft").show();f(window).off("scroll.SelectMenu")};b.prototype.afterAction=function(i){if(i.option.multiple){if(i.option.selectToCloseList){i.hideResults(i);i.elem.input.blur()}else{i.elem.input.focus()}}else{i.hideResults(i);i.elem.input.blur()}};b.prototype.getCurrentLine=function(i){if(i.elem.container.is(":hidden")){return false}var j=i.elem.results.find("li."+i.css_class.select);if(j.size()){return j}else{return false}};b.prototype.getSelectedLine=function(i){if(i.elem.container.is(":hidden")){return false}var j=i.elem.results.find("li."+i.css_class.selected);if(j.size()){return j}else{return false}};b.prototype.selectCurrentLine=function(i,j){var m=i.getCurrentLine(i),l=i.option;if(m){var k=m.data("dataObj"),n=String(k[l.keyField]);if(f.inArray(k,i.prop.values)===-1){if(!l.multiple){i.prop.values.splice(0,i.prop.values.length)}i.prop.values.push(k);m.addClass(i.css_class.selected)}else{i.prop.values.splice(f.inArray(k,i.prop.values),1);m.removeClass(i.css_class.selected)}if(l.eSelect&&f.isFunction(l.eSelect)){if(l.multiple){l.eSelect.call(i,i.prop.values)}else{l.eSelect.call(i,[k])}}i.prop.prev_value=i.elem.input.val();i.prop.selected_text=i.elem.input.val()}i.afterAction(i)};b.prototype.selectAllLine=function(i){i.elem.results.find("li").each(function(j,l){var k=f(l).data("dataObj");if(f.inArray(k,i.prop.values)===-1){i.prop.values.push(k)}f(this).addClass(i.css_class.selected)});if(i.option.eSelect&&f.isFunction(i.option.eSelect)){i.option.eSelect.call(i,i.prop.values)}i.afterAction(i)};b.prototype.clearAll=function(i){var k=i.option,j=i.elem;j.input.val("");j.results.find("li").each(function(l,m){f(this).removeClass(i.css_class.selected)});i.prop.values.splice(0,i.prop.values.length);i.afterAction(i);if(k.eSelect&&f.isFunction(k.eSelect)){k.eSelect.call(i,[])}};b.prototype.nextLine=function(r){var n=r.getCurrentLine(r),j=r.elem,q;if(!n){q=-1}else{q=j.results.children("li").index(n);n.removeClass(r.css_class.select)}q++;var s=j.results.find("li").size();if(q===s){q=s-1}if(q<s){var o=j.results.children("li").eq(q);o.addClass(r.css_class.select);var m=j.results.find("li:first").outerHeight(true),l=o.position().top,i=j.resultArea.scrollTop(),k=j.resultArea.outerHeight(true),p=l+m-k;if((l+m)>k){j.resultArea.scrollTop(i+p)}}};b.prototype.prevLine=function(q){var j=q.elem,p,o=q.getCurrentLine(q);if(!o){p=j.results.children("li").length}else{p=j.result.children("li").index(o);o.removeClass(q.css_class.select)}p--;if(p<0){p=0}if(p>-1){n.addClass(q.css_class.select);var n=j.results.children("li").eq(p),m=j.results.find("li:first").outerHeight(true),l=n.position().top,i=j.resultArea.scrollTop(),k=j.resultArea.outerHeight(true);if(l<0){j.resultArea.scrollTop(i-(0-l))}}};b.prototype.isVisible=function(i){return i.elem.container.hasClass(i.css_class.container_open)};function d(i){return this.each(function(){var k=f(this),j=k.data(b.dataKey),l=f.extend({},g,k.data(),j&&j.option,typeof i==="object"&&i);if(!j){k.data(b.dataKey,(j=new b(this,l)))}else{if(j.isVisible(j)){j.hideResults(j)}else{j.showMenu(j)}}})}function c(){return this.each(function(){var j=f(this),i=j.data(b.dataKey);if(i){i.hideResults(i)}})}function e(){return this.each(function(){var j=f(this),i=j.data(b.dataKey);if(i){i.clearAll(i)}})}var a=f.fn.selectMenu;f.fn.selectMenu=d;f.fn.selectMenu.Constructor=b;f.fn.selectMenuHide=c;f.fn.selectMenuClear=e;f.fn.selectMenu.noConflict=function(){f.fn.selectMenu=a;return this}})(window.jQuery);